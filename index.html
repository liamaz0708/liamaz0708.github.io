<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dating Connection Map üíï</title>
    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
            background-color: #f5e1f7;
        }
        #mapContainer {
            position: relative;
            width: 90%;
            height: 500px;
            border: 2px solid black;
            background-color: #fff;
            margin: auto;
            overflow: hidden;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
        }
        .controls {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Dating Connection Map üíï</h1>
    <p>Create stick figure avatars and connect them!</p>

    <div class="controls">
        <input type="text" id="friendName" placeholder="Friend's Name">
        <label>Hair Color:</label>
        <input type="color" id="hairColor">
        <label>Body Color:</label>
        <input type="color" id="bodyColor">
        <label>Height:</label>
        <input type="range" id="height" min="30" max="80" value="50">
        <button onclick="addFriend()">Add Friend</button>
    </div>

    <br>

    <select id="friend1"></select>
    <select id="friend2"></select>
    <label>Connection:</label>
    <select id="connectionType">
        <option value="dated">They Dated ‚ù§Ô∏è</option>
        <option value="talked">They Just Talked üí¨</option>
    </select>
    <button onclick="connectFriends()">Connect</button>

    <div id="mapContainer">
        <canvas id="connectionCanvas"></canvas>
    </div>

    <script>
        const mapContainer = document.getElementById("mapContainer");
        const canvas = document.getElementById("connectionCanvas");
        const ctx = canvas.getContext("2d");
        canvas.width = mapContainer.clientWidth;
        canvas.height = mapContainer.clientHeight;

        let friends = [];
        let connections = [];

        function addFriend() {
            const name = document.getElementById("friendName").value.trim();
            const hairColor = document.getElementById("hairColor").value;
            const bodyColor = document.getElementById("bodyColor").value;
            const height = document.getElementById("height").value;

            if (!name) return alert("Enter a valid name!");

            const friend = {
                name,
                x: Math.random() * (mapContainer.clientWidth - 60),
                y: Math.random() * (mapContainer.clientHeight - 80),
                hairColor,
                bodyColor,
                height: parseInt(height),
                isDragging: false
            };

            friends.push(friend);
            updateFriendSelects();
            drawScene();
        }

        function updateFriendSelects() {
            const friend1 = document.getElementById("friend1");
            const friend2 = document.getElementById("friend2");
            friend1.innerHTML = "";
            friend2.innerHTML = "";

            friends.forEach(friend => {
                const option1 = new Option(friend.name, friend.name);
                const option2 = new Option(friend.name, friend.name);
                friend1.add(option1);
                friend2.add(option2);
            });
        }

        function connectFriends() {
            const name1 = document.getElementById("friend1").value;
            const name2 = document.getElementById("friend2").value;
            const connectionType = document.getElementById("connectionType").value;

            if (name1 === name2) return alert("A person cannot date themselves!");

            const friend1 = friends.find(f => f.name === name1);
            const friend2 = friends.find(f => f.name === name2);

            if (connections.some(c => (c.a === friend1 && c.b === friend2) || (c.a === friend2 && c.b === friend1))) {
                return alert("These friends are already connected!");
            }

            connections.push({ a: friend1, b: friend2, type: connectionType });
            drawScene();
        }

        function drawScene() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw connections
            connections.forEach(({ a, b, type }) => {
                ctx.strokeStyle = type === "dated" ? "red" : "blue";
                ctx.lineWidth = type === "dated" ? 4 : 2;
                ctx.beginPath();
                ctx.moveTo(a.x + 30, a.y + 40);
                ctx.lineTo(b.x + 30, b.y + 40);
                ctx.stroke();
            });

            // Draw friends
            friends.forEach(friend => drawStickFigure(friend));
        }

        function drawStickFigure(friend) {
            ctx.fillStyle = friend.bodyColor;
            ctx.strokeStyle = "black";
            ctx.lineWidth = 2;

            let headSize = 20;
            let bodyHeight = friend.height;

            // Draw name above figure
            ctx.fillStyle = "black";
            ctx.font = "12px Arial";
            ctx.fillText(friend.name, friend.x + 15, friend.y - 5);

            // Draw head
            ctx.fillStyle = "white";
            ctx.beginPath();
            ctx.arc(friend.x + 30, friend.y + 20, headSize / 2, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Draw hair
            ctx.fillStyle = friend.hairColor;
            ctx.fillRect(friend.x + 20, friend.y + 10, 20, 10);

            // Draw body
            ctx.strokeStyle = friend.bodyColor;
            ctx.beginPath();
            ctx.moveTo(friend.x + 30, friend.y + 20);
            ctx.lineTo(friend.x + 30, friend.y + 20 + bodyHeight);
            ctx.stroke();

            // Draw arms
            ctx.beginPath();
            ctx.moveTo(friend.x + 10, friend.y + 30);
            ctx.lineTo(friend.x + 50, friend.y + 30);
            ctx.stroke();

            // Draw legs
            ctx.beginPath();
            ctx.moveTo(friend.x + 30, friend.y + 20 + bodyHeight);
            ctx.lineTo(friend.x + 15, friend.y + 20 + bodyHeight + 20);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(friend.x + 30, friend.y + 20 + bodyHeight);
            ctx.lineTo(friend.x + 45, friend.y + 20 + bodyHeight + 20);
            ctx.stroke();
        }

        let draggingFriend = null;
        let offsetX, offsetY;

        canvas.addEventListener("mousedown", (e) => {
            const mouseX = e.offsetX;
            const mouseY = e.offsetY;

            friends.forEach(friend => {
                let headSize = 20;
                if (mouseX > friend.x + 20 && mouseX < friend.x + 40 && mouseY > friend.y && mouseY < friend.y + headSize) {
                    draggingFriend = friend;
                    offsetX = mouseX - friend.x;
                    offsetY = mouseY - friend.y;
                }
            });
        });

        canvas.addEventListener("mousemove", (e) => {
            if (draggingFriend) {
                draggingFriend.x = e.offsetX - offsetX;
                draggingFriend.y = e.offsetY - offsetY;
                drawScene();
            }
        });

        canvas.addEventListener("mouseup", () => {
            draggingFriend = null;
        });

        drawScene();
    </script>
</body>
</html>
