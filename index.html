<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dating Connection Map ðŸ’•</title>
    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
            background-color: #f5e1f7;
        }
        #mapContainer {
            position: relative;
            width: 90%;
            height: 500px;
            border: 2px solid black;
            background-color: #fff;
            margin: auto;
            overflow: hidden;
        }
        .friend {
            position: absolute;
            width: 60px;
            height: 60px;
            background-color: pink;
            border-radius: 50%;
            text-align: center;
            line-height: 60px;
            font-size: 14px;
            font-weight: bold;
            cursor: grab;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <h1>Dating Connection Map ðŸ’•</h1>
    <p>Add your friends and connect couples!</p>

    <input type="text" id="friendName" placeholder="Enter a friend's name">
    <button onclick="addFriend()">Add Friend</button>

    <br><br>

    <select id="friend1"></select>
    <select id="friend2"></select>
    <button onclick="connectFriends()">Connect</button>

    <div id="mapContainer">
        <canvas id="connectionCanvas"></canvas>
    </div>

    <script>
        const mapContainer = document.getElementById("mapContainer");
        const canvas = document.getElementById("connectionCanvas");
        const ctx = canvas.getContext("2d");
        canvas.width = mapContainer.clientWidth;
        canvas.height = mapContainer.clientHeight;

        let friends = [];
        let connections = [];

        function addFriend() {
            const name = document.getElementById("friendName").value.trim();
            if (!name) return alert("Enter a valid name!");

            const friend = document.createElement("div");
            friend.className = "friend";
            friend.textContent = name;
            friend.style.left = Math.random() * (mapContainer.clientWidth - 60) + "px";
            friend.style.top = Math.random() * (mapContainer.clientHeight - 60) + "px";

            friend.dataset.name = name;
            friend.dataset.x = parseFloat(friend.style.left);
            friend.dataset.y = parseFloat(friend.style.top);
            friend.draggable = true;

            friend.addEventListener("mousedown", startDrag);

            mapContainer.appendChild(friend);
            friends.push(friend);

            updateFriendSelects();
            document.getElementById("friendName").value = "";
            drawConnections();
        }

        function updateFriendSelects() {
            const friend1 = document.getElementById("friend1");
            const friend2 = document.getElementById("friend2");
            friend1.innerHTML = "";
            friend2.innerHTML = "";

            friends.forEach(friend => {
                const option1 = new Option(friend.dataset.name, friend.dataset.name);
                const option2 = new Option(friend.dataset.name, friend.dataset.name);
                friend1.add(option1);
                friend2.add(option2);
            });
        }

        function connectFriends() {
            const name1 = document.getElementById("friend1").value;
            const name2 = document.getElementById("friend2").value;
            if (name1 === name2) return alert("A person cannot date themselves!");

            const friend1 = friends.find(f => f.dataset.name === name1);
            const friend2 = friends.find(f => f.dataset.name === name2);

            if (connections.some(c => (c.a === friend1 && c.b === friend2) || (c.a === friend2 && c.b === friend1))) {
                return alert("These friends are already connected!");
            }

            connections.push({ a: friend1, b: friend2 });
            drawConnections();
        }

        function drawConnections() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = "red";
            ctx.lineWidth = 3;

            connections.forEach(({ a, b }) => {
                ctx.beginPath();
                ctx.moveTo(parseFloat(a.dataset.x) + 30, parseFloat(a.dataset.y) + 30);
                ctx.lineTo(parseFloat(b.dataset.x) + 30, parseFloat(b.dataset.y) + 30);
                ctx.stroke();
            });
        }

        let draggedElement = null;
        let offsetX, offsetY;

        function startDrag(e) {
            draggedElement = e.target;
            offsetX = e.clientX - parseFloat(draggedElement.dataset.x);
            offsetY = e.clientY - parseFloat(draggedElement.dataset.y);

            document.addEventListener("mousemove", drag);
            document.addEventListener("mouseup", stopDrag);
        }

        function drag(e) {
            if (!draggedElement) return;

            let x = e.clientX - offsetX;
            let y = e.clientY - offsetY;

            x = Math.max(0, Math.min(mapContainer.clientWidth - 60, x));
            y = Math.max(0, Math.min(mapContainer.clientHeight - 60, y));

            draggedElement.style.left = x + "px";
            draggedElement.style.top = y + "px";
            draggedElement.dataset.x = x;
            draggedElement.dataset.y = y;

            drawConnections();
        }

        function stopDrag() {
            document.removeEventListener("mousemove", drag);
            document.removeEventListener("mouseup", stopDrag);
            draggedElement = null;
        }
    </script>
</body>
</html>
